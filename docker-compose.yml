# version: '3.7'
# services:
#   zookeeper: 
#     image: 'zookeeper:3.6.3' 
#     container_name: 'zookeeper'
#     ports:
#       - '2181:2181' 
#   kafka: 
#     image: 'confluentinc/cp-kafka:6.2.0'
#     container_name: 'kafka'
#     depends_on:
#       - zookeeper
#     ports: 
#       - '9092:9092'
#     environment:
#       KAFKA_ENABLE_KRAFT: 'yes'
#       KAFKA_ADVERTISED_LISTENERS: 'PLAINTEXT://localhost:9092'
#       KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
#       KAFKA_ZOOKEEPER_CONNECT: 'zookeeper:2181'
      
version: "3.7"
services:
  kafka:
    image: bitnami/kafka
    container_name: kafka
    ports:
      - 9092:9092
    environment:
      - KAFKA_ENABLE_KRAFT=yes
      - KAFKA_CFG_PROCESS_ROLES=broker,controller
      - KAFKA_CFG_CONTROLLER_LISTENER_NAMES=CONTROLLER
      - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092,CONTROLLER://:2181
      - KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT
      - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://127.0.0.1:9092
      - KAFKA_BROKER_ID=1
      - KAFKA_CFG_CONTROLLER_QUORUM_VOTERS=1@127.0.0.1:2181
      - ALLOW_PLAINTEXT_LISTENER=yes
      - KAFKA_CFG_NODE_ID=1
      - KAFKA_KRAFT_CLUSTER_ID=MkU3OEVBNTcwNTJENDM2Qk
    volumes:
      - ./kafka:/bitnami/kafka

# run 'docker compose up' to initialize container locally